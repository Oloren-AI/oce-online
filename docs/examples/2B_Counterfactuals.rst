Plotting counterfactuals
========================

Background
----------

Counterfactuals are datapoints that try to answer the question “what is
the smallest change to the features that would alter the prediction?” In
the context of chemical ML, it involves determining the smallest change
to an input molecule that would cause a model to change its prediction.

Counterfactual selection is based on the Python package
`exmol <https://github.com/ur-whitelab/exmol>`__. Detailed methods and
analysis can be accessed in their
`paper <https://doi.org/10.1039/D1SC05259D>`__, but here we will briefly
overview how counterfactuals are identified and plotted with oce.

Methods
-------

Selecting counterfactuals can be broken down into several steps: 1.
**Sample the chemical space around the target molecule.** This is done
with our PerturbationEngine class of methods. 2. **Run the model and
compute the similarity from the target molecule.** We use Tanimoto
similarity of the molecules’ Morgan fingerprints. 3. **Cluster and
select counterfactuals.** Density-based clustering is performed in the
PCA-reduced space of the affinity matrix. The most similar
conuterfactual(s) from each cluster are saved. 4. **Plot
counterfactuals.** This can either be done in the PCA-reduced space, or
in similiarity-output space.

Below, we demonstrate how to run this pipeline with an arbitrary model.

Example plots
-------------

In this example, we will train a model on the lipophilicity dataset from
`MoleculeNet <https://moleculenet.org/datasets-1>`__.

.. code:: ipython3

    import olorenchemengine as oce
    from rdkit import Chem
    import pandas as pd

.. code:: ipython3

    dataset = oce.load('lipophilicity_dataset.oce')
    model = oce.load('lipophilicity_model_rf.oce')


.. parsed-literal::

    Using backend: pytorch


We will select a molecule from the testing dataset to use as our
reference molecule.

.. code:: ipython3

    smiles = dataset.test_dataset[0].loc[3780, 'smiles']

.. code:: ipython3

    Chem.MolFromSmiles(smiles)




.. image:: 2B_Counterfactuals_files/2B_Counterfactuals_9_0.png



We can now build our visualization object using the
``VisualizeCounterfactual`` method. Here, we set ``delta = 0.5``,
indicating that every compound with a predicted value that differs from
the predicted value of the reference by more than 0.5 is a potential
counterfactual.

.. code:: ipython3

    vis = oce.VisualizeCounterfactual(smiles, model, delta=0.5)


.. parsed-literal::

    100%|██████████| 28/28 [00:17<00:00,  1.58it/s]
    100%|██████████| 32263/32263 [00:10<00:00, 3065.50it/s]
    100%|██████████| 5303/5303 [00:42<00:00, 124.51it/s]


Finally, we can plot the selected counterfactuals using the
``render_ipynb`` method.

.. code:: ipython3

    vis.render_ipynb()




.. raw:: html

    
    <iframe
        width="800"
        height="600"
        src="data:text/html,%0A%20%20%20%20%20%20%20%20%3C%21DOCTYPE%20html%3E%0A%20%20%20%20%20%20%20%20%3Chead%3E%0A%20%20%20%20%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%3E%0A%20%20%20%20%20%20%20%20%3C%2Fhead%3E%0A%0A%20%20%20%20%20%20%20%20%3Chtml%20style%3D%22height%3A%20100%25%3B%22%3E%0A%0A%20%20%20%20%20%20%20%20%3C%21--%20Load%20packages%20--%3E%0A%20%20%20%20%20%20%20%20%3Cscript%20src%3D%22https%3A%2F%2Fcdn.plot.ly%2Fplotly-2.12.1.min.js%22%3E%3C%2Fscript%3E%3Cscript%20src%3D%22https%3A%2F%2Funpkg.com%2Fsmiles-drawer%401.0.10%2Fdist%2Fsmiles-drawer.min.js%22%3E%3C%2Fscript%3E%0A%20%20%20%20%20%20%20%20%3Cbody%20style%3D%22background-color%3A%23FFFFFF%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%3C%21--%20Create%20a%20div%20where%20the%20graph%20will%20take%20place%20--%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22basevis-entry%22%20data-visdata%3D%22%7B%26quot%3BSMILES%26quot%3B%3A%20%5B%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNC%5BNH2%2B%5D2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29cnc1%5BO-%5D%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28C3%29CP%28C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28C%5BNH%2B%5D2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CP%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2NCCC%5BNH2%2B%5D2%29ccc1Cl%26quot%3B%2C%20%26quot%3BCc1cc%28Cl%29c%28C%28%3DO%29NCC23CC4CC%28CC%28C4%29C2%29C3%29c%5Bn%2B%5D1CC1CCNCC1%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cn%5BnH%2B%5Dc%28CC2CCNCC2%29c1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28C2CCCNCC%5BNH2%2B%5D2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CN%28C3%29N1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCOCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNSC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCO2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCC23CC3%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28SC2CCNCS2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc2c%28cc1Cl%29C1CNCCOC2O1%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29C1%3DCN%3DC%28C2C3CNCC32%29C%3DCC%3DC1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28C3%29CC%28C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BCc1ccc%28CC2CCNCC2%29cc1C%28%3DO%29NCC12CC3CC%28CC%28C3%29C1%29C2%26quot%3B%2C%20%26quot%3BS%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29cc%28Cl%29c1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNNC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BCC%28C%29%28C%29c1ccc%28CC2CCNCC2%29cc1C%28%3DO%29NCC12CC3CC%28CC%28C3%29C1%29C2%26quot%3B%2C%20%26quot%3BNN%28CC12CC3CC%28CC%28C3%29C1%29C2%29C%28%3DO%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29%5BnH%2B%5Dcc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCN2%29ccc1Cl%26quot%3B%2C%20%26quot%3BCc1%5BnH%2B%5Dcc%28CC2CCNCC2%29cc1C%28%3DO%29NCC12CC3CC%28CC%28C3%29C1%29C2%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1nc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BOC%28%3DNCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DS%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28C1%29NC%28C3%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BClc1ccc%28CC2CCNCC2%29cc1SNCC12CC3CC%28CC%28C3%29C1%29C2%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28C3%29C%5BNH%2B%5D%28C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BCC%28%3DO%29C%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28O%29%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%5BnH%2B%5Dc%28CC2CCNCC2%29c1Cl%26quot%3B%2C%20%26quot%3BCC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%5D%2C%20%26quot%3BX%26quot%3B%3A%20%5B1.0%2C%200.782608695652174%2C%200.7634408602150538%2C%200.7608695652173914%2C%200.7446808510638298%2C%200.7446808510638298%2C%200.7263157894736842%2C%200.711340206185567%2C%200.7083333333333334%2C%200.6868686868686869%2C%200.6565656565656566%2C%200.8470588235294118%2C%200.8021978021978022%2C%200.8021978021978022%2C%200.782608695652174%2C%200.7340425531914894%2C%200.673469387755102%2C%200.5462962962962963%2C%200.4649122807017544%2C%200.9285714285714286%2C%200.8636363636363636%2C%200.8636363636363636%2C%200.8043478260869565%2C%200.8021978021978022%2C%200.8%2C%200.7849462365591398%2C%200.782608695652174%2C%200.782608695652174%2C%200.7634408602150538%2C%200.7634408602150538%2C%200.7634408602150538%2C%200.7634408602150538%2C%200.7634408602150538%2C%200.7608695652173914%2C%200.7608695652173914%2C%200.7604166666666666%2C%200.7473684210526316%2C%200.7446808510638298%2C%200.7446808510638298%5D%2C%20%26quot%3BY%26quot%3B%3A%20%5B1.81105723128978%2C%201.220931484214315%2C%201.2745855367793966%2C%201.2713290059376905%2C%200.949196805666557%2C%201.2703725095329519%2C%201.0928634762500582%2C%201.3061451034243525%2C%201.2520993161657312%2C%201.3093586762151253%2C%201.2871587023646305%2C%203.0976771448331064%2C%203.1147045250052234%2C%202.3914778625590096%2C%202.54105841058533%2C%203.100531772839906%2C%202.3720770198976293%2C%202.5335685768920624%2C%202.316965742225911%2C%201.8056226800354787%2C%201.7839250527322263%2C%201.9536920679263978%2C%201.9335427424721818%2C%201.4351390759257079%2C%201.9677530786242055%2C%201.8090433384613749%2C%201.4056729675837576%2C%201.4572750802547132%2C%201.3515318652474972%2C%201.5800397665280623%2C%201.9638479579807449%2C%201.8450938927779736%2C%201.471009322312878%2C%201.9717546450641292%2C%201.4702497194884152%2C%201.8609247878853603%2C%201.7353604107901903%2C%201.3299375322863412%2C%201.8891367933464025%5D%2C%20%26quot%3Bcolor%26quot%3B%3A%20%5B%26quot%3B%2300CC96%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%5D%2C%20%26quot%3Bhovertemplate%26quot%3B%3A%20%5B%26quot%3Bf%28x%29%20%3D%201.811%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.78%3Cbr%3Ef%28x%29%20%3D%201.221%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.275%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.271%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.74%3Cbr%3Ef%28x%29%20%3D%200.949%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.74%3Cbr%3Ef%28x%29%20%3D%201.27%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.73%3Cbr%3Ef%28x%29%20%3D%201.093%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.71%3Cbr%3Ef%28x%29%20%3D%201.306%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.71%3Cbr%3Ef%28x%29%20%3D%201.252%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.69%3Cbr%3Ef%28x%29%20%3D%201.309%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.66%3Cbr%3Ef%28x%29%20%3D%201.287%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.85%3Cbr%3Ef%28x%29%20%3D%203.098%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%203.115%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%202.391%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.78%3Cbr%3Ef%28x%29%20%3D%202.541%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.73%3Cbr%3Ef%28x%29%20%3D%203.101%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.67%3Cbr%3Ef%28x%29%20%3D%202.372%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.55%3Cbr%3Ef%28x%29%20%3D%202.534%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.46%3Cbr%3Ef%28x%29%20%3D%202.317%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.93%3Cbr%3Ef%28x%29%20%3D%201.806%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.86%3Cbr%3Ef%28x%29%20%3D%201.784%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.86%3Cbr%3Ef%28x%29%20%3D%201.954%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%201.934%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%201.435%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%201.968%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.78%3Cbr%3Ef%28x%29%20%3D%201.809%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.78%3Cbr%3Ef%28x%29%20%3D%201.406%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.78%3Cbr%3Ef%28x%29%20%3D%201.457%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.352%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.58%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.964%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.845%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.471%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.972%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.47%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.861%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.75%3Cbr%3Ef%28x%29%20%3D%201.735%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.74%3Cbr%3Ef%28x%29%20%3D%201.33%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.74%3Cbr%3Ef%28x%29%20%3D%201.889%26quot%3B%5D%2C%20%26quot%3Bgroup%26quot%3B%3A%20%5B%26quot%3BBase%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%5D%2C%20%26quot%3Bsize%26quot%3B%3A%20%5B12%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%5D%2C%20%26quot%3Btitle%26quot%3B%3A%20%26quot%3BCounterfactual%20Visualization%26quot%3B%2C%20%26quot%3Bxaxis_title%26quot%3B%3A%20%26quot%3BSimilarity%26quot%3B%2C%20%26quot%3Byaxis_title%26quot%3B%3A%20%26quot%3Bf%28x%29%26quot%3B%2C%20%26quot%3Bhover_size%26quot%3B%3A%200.4%2C%20%26quot%3Bxaxis_type%26quot%3B%3A%20%26quot%3Blinear%26quot%3B%2C%20%26quot%3Byaxis_type%26quot%3B%3A%20%26quot%3Blinear%26quot%3B%2C%20%26quot%3Bwidth%26quot%3B%3A%20800%2C%20%26quot%3Bheight%26quot%3B%3A%20600%2C%20%26quot%3Bopacity%26quot%3B%3A%201%7D%22%20style%3D%22width%3A%20100%25%3B%20height%3A%20100%25%3B%20display%3Ainline-block%3B%22%3E%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%3C%2Fbody%3E%0A%20%20%20%20%20%20%20%20%3C%2Fmeta%3E%0A%20%20%20%20%20%20%20%20%3Cscript%3Evar%20plot%20%3D%20document.getElementById%28%22basevis-entry%22%29%3B%0Avar%20hoverInfo%20%3D%20document.getElementById%28%22basevis-entry2%22%29%3B%0A%0Avar%20data%20%3D%20JSON.parse%28document.getElementById%28%22basevis-entry%22%29.dataset.visdata%29%3B%0A%0Alet%20options%20%3D%20%7B%7D%3B%0Alet%20smilesDrawer%20%3D%20new%20SmilesDrawer.Drawer%28options%29%3B%0A%0Avar%20trace%20%3D%20%7B%0A%20%20x%3A%20data.X%2C%0A%20%20y%3A%20data.Y%2C%0A%20%20text%3A%20data.SMILES%2C%0A%20%20mode%3A%20%22markers%22%2C%0A%20%20type%3A%20%22scatter%22%2C%0A%20%20hoverinfo%3A%20%22none%22%2C%0A%20%20marker%3A%20%7B%7D%2C%0A%7D%3B%0A%0Aif%20%28%22hovertext%22%20in%20data%29%20%7B%0A%20%20trace.hovertext%20%3D%20data.hovertext%3B%0A%20%20trace.hoverinfo%20%3D%20%22text%22%3B%0A%7D%0A%0Aif%20%28%22group%22%20in%20data%29%20%7B%0A%20%20trace.transforms%20%3D%20%5B%7B%20type%3A%20%22groupby%22%2C%20groups%3A%20data.group%20%7D%5D%3B%0A%7D%0A%0Aif%20%28%22hovertemplate%22%20in%20data%29%20%7B%0A%20%20trace.hovertemplate%20%3D%20data.hovertemplate%3B%0A%7D%0A%0Aif%20%28%22color%22%20in%20data%29%20%7B%0A%20%20trace.marker.color%20%3D%20data.color%3B%0A%7D%0A%0Aif%20%28%22size%22%20in%20data%29%20%7B%0A%20%20trace.marker.size%20%3D%20data.size%3B%0A%7D%20else%20%7B%0A%20%20trace.marker.size%20%3D%2012%3B%0A%7D%0A%0Aif%20%28%22colorscale%22%20in%20data%29%20%7B%0A%20%20trace.colorscale%20%3D%20data.colorscale%3B%0A%20%20trace.marker.colorscale%20%3D%20data.colorscale%3B%0A%20%20trace.marker.colorbar%20%3D%20%7B%0A%20%20%20%20title%3A%20%22%22%2C%0A%20%20%20%20titleside%3A%20%22top%22%2C%0A%20%20%7D%3B%0A%7D%0A%0A%2F%2F%20if%20%28%22outline%22%20in%20data%29%20%7B%0A%2F%2F%20%20%20trace.marker.line%20%3D%20%7B%0A%2F%2F%20%20%20%20%20color%3A%20data.outline%2C%0A%2F%2F%20%20%20%20%20width%3A%204%2C%0A%2F%2F%20%20%20%7D%3B%0A%2F%2F%20%7D%0A%0Aif%20%28%22opacity%22%20in%20data%29%20%7B%0A%20%20trace.marker.opacity%20%3D%20data.opacity%3B%0A%7D%0A%0Avar%20plot_data%20%3D%20%5Btrace%5D%3B%0A%0Avar%20layout%20%3D%20%7B%0A%20%20title%3A%20%22Plot%20Title%22%2C%0A%20%20xaxis%3A%20%7B%0A%20%20%20%20title%3A%20%22x%20Axis%22%2C%0A%20%20%7D%2C%0A%20%20yaxis%3A%20%7B%0A%20%20%20%20title%3A%20%22y%20Axis%22%2C%0A%20%20%7D%2C%0A%20%20width%3A%20data.width%2C%0A%20%20height%3A%20data.height%2C%0A%20%20autosize%3A%20true%2C%0A%7D%3B%0A%0Aif%20%28%22title%22%20in%20data%29%20%7B%0A%20%20layout.title%20%3D%20data.title%3B%0A%7D%0A%0Aif%20%28%22xaxis_title%22%20in%20data%29%20%7B%0A%20%20layout.xaxis.title%20%3D%20data.xaxis_title%3B%0A%7D%0A%0Aif%20%28%22yaxis_title%22%20in%20data%29%20%7B%0A%20%20layout.yaxis.title%20%3D%20data.yaxis_title%3B%0A%7D%0A%0Alayout.xaxis.type%20%3D%20data%5B%22xaxis_type%22%5D%3B%0Alayout.yaxis.type%20%3D%20data%5B%22yaxis_type%22%5D%3B%0A%0Aif%20%28%22ydomain%22%20in%20data%29%7B%0A%20%20layout.yaxis.domain%20%3D%20data.ydomain%3B%0A%7D%0Aif%20%28%22xdomain%22%20in%20data%29%7B%0A%20%20layout.xaxis.domain%20%3D%20data.xdomain%3B%0A%7D%0A%0Aif%20%28%22yrange%22%20in%20data%29%7B%0A%20%20layout.yaxis.range%20%3D%20data.yrange%3B%0A%7D%0Aif%20%28%22xrange%22%20in%20data%29%7B%0A%20%20layout.xaxis.range%20%3D%20data.xrange%3B%0A%7D%0A%0Aif%20%28%22axesratio%22%20in%20data%29%7B%0A%20%20layout.yaxis.scaleanchor%20%3D%20%22x%22%3B%0A%20%20layout.yaxis.scaleratio%20%3D%20data.axesratio%3B%0A%7D%0A%0Aif%20%28%22xdtick%22%20in%20data%29%7B%0A%20%20layout.xaxis.dtick%20%3D%20data.xdtick%3B%0A%7D%0A%0Aif%20%28%22ydtick%22%20in%20data%29%7B%0A%20%20layout.yaxis.dtick%20%3D%20data.ydtick%3B%0A%7D%0A%0APlotly.newPlot%28%0A%20%20%22basevis-entry%22%2C%0A%20%20plot_data%2C%0A%20%20layout%2C%0A%20%20%28config%20%3D%20%7B%0A%20%20%20%20displaylogo%3A%20false%2C%0A%20%20%20%20modeBarButtonsToRemove%3A%20%5B%22zoom2d%22%2C%20%22pan2d%22%2C%20%22select2d%22%2C%20%22lasso2d%22%5D%2C%0A%20%20%7D%29%0A%29%3B%0A%0Aif%20%28%22layout_update%22%20in%20data%29%7B%0A%20%20Plotly.update%28%22basevis-entry%22%2C%20%7B%7D%2C%20data.layout_update%29%3B%0A%7D%0A%0Aif%20%28%22trace_update%22%20in%20data%29%7B%0A%20%20Plotly.addTraces%28%22basevis-entry%22%2C%20data.trace_update%29%3B%0A%7D%0A%0Aconst%20hoverCanvas%20%3D%20document.createElement%28%22canvas%22%29%3B%0AhoverCanvas.id%20%3D%20%22hoverCanvas%22%3B%0A%0Aconst%20hoverBackground%20%3D%20document.createElement%28%22canvas%22%29%3B%0AhoverBackground.id%20%3D%20%22hoverBackground%22%3B%0A%0Avar%20hoverSize%20%3D%20parseFloat%28data.hover_size%29%3B%0A%0Aplot.appendChild%28hoverCanvas%29%3B%0Aplot.appendChild%28hoverBackground%29%3B%0A%0Aplot%0A%20%20.on%28%22plotly_hover%22%2C%20function%20%28data%29%20%7B%0A%20%20%20%20var%20xaxis%20%3D%20data.points%5B0%5D.xaxis%2C%0A%20%20%20%20%20%20yaxis%20%3D%20data.points%5B0%5D.yaxis%3B%0A%0A%20%20%20%20data.points.map%28function%20%28d%29%20%7B%0A%20%20%20%20%20%20hoverCanvas.hidden%20%3D%20false%3B%0A%20%20%20%20%20%20hoverBackground.hidden%20%3D%20false%3B%0A%0A%20%20%20%20%20%20ctx%20%3D%20hoverCanvas.getContext%28%222d%22%29%3B%0A%0A%20%20%20%20%20%20SmilesDrawer.parse%28d.text%2C%20function%20%28smiles%29%20%7B%0A%20%20%20%20%20%20%20%20smilesDrawer.draw%28smiles%2C%20%22hoverCanvas%22%2C%20%22light%22%2C%20false%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%20%20ctx.fillStyle%20%3D%20%22black%22%3B%0A%20%20%20%20%20%20ctx.shadowColor%20%3D%20%22black%22%3B%0A%20%20%20%20%20%20ctx.shadowBlur%20%3D%2020%3B%0A%20%20%20%20%20%20ctx.lineJoin%20%3D%20%22bevel%22%3B%0A%20%20%20%20%20%20ctx.lineWidth%20%3D%2015%3B%0A%20%20%20%20%20%20ctx.strokeRect%280%2C%200%2C%20hoverCanvas.width%2C%20hoverCanvas.height%2C%20%22light%22%29%3B%0A%0A%20%20%20%20%20%20hoverBackground.width%20%3D%20hoverCanvas.width%3B%0A%20%20%20%20%20%20hoverBackground.height%20%3D%20hoverCanvas.height%3B%0A%20%20%20%20%20%20ctx%20%3D%20hoverBackground.getContext%28%222d%22%29%3B%0A%20%20%20%20%20%20ctx.fillStyle%20%3D%20%22white%22%3B%0A%20%20%20%20%20%20ctx.fillRect%280%2C%200%2C%20hoverBackground.width%2C%20hoverBackground.height%29%3B%0A%0A%20%20%20%20%20%20Plotly.update%28%0A%20%20%20%20%20%20%20%20%22basevis-entry%22%2C%0A%20%20%20%20%20%20%20%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20margin%3A%20%7B%20t%3A%20100%2C%20b%3A%20100%2C%20l%3A%2050%2C%20r%3A%2050%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20annotations%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20d.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20d.y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xref%3A%20%22x%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yref%3A%20%22y%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3A%20%22%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20showarrow%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowhead%3A%207%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20ax%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20ay%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20images%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20%28d.x%20-%20xaxis.range%5B0%5D%29%20%2F%20%28xaxis.range%5B1%5D%20-%20xaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20%28d.y%20-%20yaxis.range%5B0%5D%29%20%2F%20%28yaxis.range%5B1%5D%20-%20yaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizex%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizey%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20source%3A%20document.getElementById%28%22hoverBackground%22%29.toDataURL%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xanchor%3A%20%22left%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yanchor%3A%20%22top%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3A%20%22above%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20%28d.x%20-%20xaxis.range%5B0%5D%29%20%2F%20%28xaxis.range%5B1%5D%20-%20xaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20%28d.y%20-%20yaxis.range%5B0%5D%29%20%2F%20%28yaxis.range%5B1%5D%20-%20yaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizex%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizey%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20source%3A%20document.getElementById%28%22hoverCanvas%22%29.toDataURL%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xanchor%3A%20%22left%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yanchor%3A%20%22top%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3A%20%22above%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20hoverCanvas.hidden%20%3D%20true%3B%0A%20%20%20%20%20%20hoverBackground.hidden%20%3D%20true%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%29%0A%20%20.on%28%22plotly_unhover%22%2C%20function%20%28data%29%20%7B%0A%20%20%20%20Plotly.update%28%22basevis-entry%22%2C%20%7B%7D%2C%20%7B%20annotations%3A%20%5B%5D%2C%20images%3A%20%5B%5D%20%7D%29%3B%0A%20%20%7D%29%3B%0A%3C%2Fscript%3E%3Cscript%3E%20window.addEventListener%28%22resize%22%2C%20function%28%29%7Bif%20%28document.getElementById%28%22basevis-entry%22%29%29%20%7BPlotly.Plots.resize%28document.getElementById%28%22basevis-entry%22%29%29%3B%7D%3B%7D%29%20%3C%2Fscript%3E"
        frameborder="0"
        allowfullscreen
    
    ></iframe>




The x-axis is the Tanimoto similarity between each sampled molecule with
the reference (base) molecule. The y-axis is the predicted value of the
molecule from the trained model. For regression models such as this one,
the y-axis will be continuous, whereas for classification models, it
will be discrete. High and low counterfactuals can also be clearly seen
as having either significantly higher or lower predicted outputs from
the reference. For classification models, everything outside of the
reference class would be simply labeled as a counterfactual.

The number of points shown (default 40) can be varied by setting
``n=__``:

.. code:: ipython3

    vis = oce.VisualizeCounterfactual(smiles, model, delta=0.5, n=10)


.. parsed-literal::

    100%|██████████| 28/28 [00:17<00:00,  1.58it/s]
    100%|██████████| 32263/32263 [00:10<00:00, 3017.44it/s]
    100%|██████████| 5303/5303 [00:42<00:00, 124.42it/s]


.. code:: ipython3

    vis.render_ipynb()




.. raw:: html

    
    <iframe
        width="800"
        height="600"
        src="data:text/html,%0A%20%20%20%20%20%20%20%20%3C%21DOCTYPE%20html%3E%0A%20%20%20%20%20%20%20%20%3Chead%3E%0A%20%20%20%20%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%3E%0A%20%20%20%20%20%20%20%20%3C%2Fhead%3E%0A%0A%20%20%20%20%20%20%20%20%3Chtml%20style%3D%22height%3A%20100%25%3B%22%3E%0A%0A%20%20%20%20%20%20%20%20%3C%21--%20Load%20packages%20--%3E%0A%20%20%20%20%20%20%20%20%3Cscript%20src%3D%22https%3A%2F%2Fcdn.plot.ly%2Fplotly-2.12.1.min.js%22%3E%3C%2Fscript%3E%3Cscript%20src%3D%22https%3A%2F%2Funpkg.com%2Fsmiles-drawer%401.0.10%2Fdist%2Fsmiles-drawer.min.js%22%3E%3C%2Fscript%3E%0A%20%20%20%20%20%20%20%20%3Cbody%20style%3D%22background-color%3A%23FFFFFF%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%3C%21--%20Create%20a%20div%20where%20the%20graph%20will%20take%20place%20--%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22basevis-entry%22%20data-visdata%3D%22%7B%26quot%3BSMILES%26quot%3B%3A%20%5B%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNC%5BNH2%2B%5D2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29cnc1%5BO-%5D%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCOCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28C3%29CC%28C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BCc1ccc%28CC2CCNCC2%29cc1C%28%3DO%29NCC12CC3CC%28CC%28C3%29C1%29C2%26quot%3B%2C%20%26quot%3BS%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29cc%28Cl%29c1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNNC2%29ccc1Cl%26quot%3B%5D%2C%20%26quot%3BX%26quot%3B%3A%20%5B1.0%2C%200.782608695652174%2C%200.7634408602150538%2C%200.8470588235294118%2C%200.8021978021978022%2C%200.9285714285714286%2C%200.8636363636363636%2C%200.8636363636363636%2C%200.8043478260869565%2C%200.8021978021978022%5D%2C%20%26quot%3BY%26quot%3B%3A%20%5B1.8110572312897801%2C%201.220931484214315%2C%201.2745855367793966%2C%203.0976771448331064%2C%203.114704525005224%2C%201.8056226800354787%2C%201.7839250527322263%2C%201.9536920679263978%2C%201.9335427424721818%2C%201.4351390759257079%5D%2C%20%26quot%3Bcolor%26quot%3B%3A%20%5B%26quot%3B%2300CC96%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%5D%2C%20%26quot%3Bhovertemplate%26quot%3B%3A%20%5B%26quot%3Bf%28x%29%20%3D%201.811%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.78%3Cbr%3Ef%28x%29%20%3D%201.221%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.275%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.85%3Cbr%3Ef%28x%29%20%3D%203.098%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%203.115%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.93%3Cbr%3Ef%28x%29%20%3D%201.806%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.86%3Cbr%3Ef%28x%29%20%3D%201.784%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.86%3Cbr%3Ef%28x%29%20%3D%201.954%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%201.934%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%201.435%26quot%3B%5D%2C%20%26quot%3Bgroup%26quot%3B%3A%20%5B%26quot%3BBase%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%5D%2C%20%26quot%3Bsize%26quot%3B%3A%20%5B12%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%5D%2C%20%26quot%3Btitle%26quot%3B%3A%20%26quot%3BCounterfactual%20Visualization%26quot%3B%2C%20%26quot%3Bxaxis_title%26quot%3B%3A%20%26quot%3BSimilarity%26quot%3B%2C%20%26quot%3Byaxis_title%26quot%3B%3A%20%26quot%3Bf%28x%29%26quot%3B%2C%20%26quot%3Bhover_size%26quot%3B%3A%200.4%2C%20%26quot%3Bxaxis_type%26quot%3B%3A%20%26quot%3Blinear%26quot%3B%2C%20%26quot%3Byaxis_type%26quot%3B%3A%20%26quot%3Blinear%26quot%3B%2C%20%26quot%3Bwidth%26quot%3B%3A%20800%2C%20%26quot%3Bheight%26quot%3B%3A%20600%2C%20%26quot%3Bopacity%26quot%3B%3A%201%7D%22%20style%3D%22width%3A%20100%25%3B%20height%3A%20100%25%3B%20display%3Ainline-block%3B%22%3E%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%3C%2Fbody%3E%0A%20%20%20%20%20%20%20%20%3C%2Fmeta%3E%0A%20%20%20%20%20%20%20%20%3Cscript%3Evar%20plot%20%3D%20document.getElementById%28%22basevis-entry%22%29%3B%0Avar%20hoverInfo%20%3D%20document.getElementById%28%22basevis-entry2%22%29%3B%0A%0Avar%20data%20%3D%20JSON.parse%28document.getElementById%28%22basevis-entry%22%29.dataset.visdata%29%3B%0A%0Alet%20options%20%3D%20%7B%7D%3B%0Alet%20smilesDrawer%20%3D%20new%20SmilesDrawer.Drawer%28options%29%3B%0A%0Avar%20trace%20%3D%20%7B%0A%20%20x%3A%20data.X%2C%0A%20%20y%3A%20data.Y%2C%0A%20%20text%3A%20data.SMILES%2C%0A%20%20mode%3A%20%22markers%22%2C%0A%20%20type%3A%20%22scatter%22%2C%0A%20%20hoverinfo%3A%20%22none%22%2C%0A%20%20marker%3A%20%7B%7D%2C%0A%7D%3B%0A%0Aif%20%28%22hovertext%22%20in%20data%29%20%7B%0A%20%20trace.hovertext%20%3D%20data.hovertext%3B%0A%20%20trace.hoverinfo%20%3D%20%22text%22%3B%0A%7D%0A%0Aif%20%28%22group%22%20in%20data%29%20%7B%0A%20%20trace.transforms%20%3D%20%5B%7B%20type%3A%20%22groupby%22%2C%20groups%3A%20data.group%20%7D%5D%3B%0A%7D%0A%0Aif%20%28%22hovertemplate%22%20in%20data%29%20%7B%0A%20%20trace.hovertemplate%20%3D%20data.hovertemplate%3B%0A%7D%0A%0Aif%20%28%22color%22%20in%20data%29%20%7B%0A%20%20trace.marker.color%20%3D%20data.color%3B%0A%7D%0A%0Aif%20%28%22size%22%20in%20data%29%20%7B%0A%20%20trace.marker.size%20%3D%20data.size%3B%0A%7D%20else%20%7B%0A%20%20trace.marker.size%20%3D%2012%3B%0A%7D%0A%0Aif%20%28%22colorscale%22%20in%20data%29%20%7B%0A%20%20trace.colorscale%20%3D%20data.colorscale%3B%0A%20%20trace.marker.colorscale%20%3D%20data.colorscale%3B%0A%20%20trace.marker.colorbar%20%3D%20%7B%0A%20%20%20%20title%3A%20%22%22%2C%0A%20%20%20%20titleside%3A%20%22top%22%2C%0A%20%20%7D%3B%0A%7D%0A%0A%2F%2F%20if%20%28%22outline%22%20in%20data%29%20%7B%0A%2F%2F%20%20%20trace.marker.line%20%3D%20%7B%0A%2F%2F%20%20%20%20%20color%3A%20data.outline%2C%0A%2F%2F%20%20%20%20%20width%3A%204%2C%0A%2F%2F%20%20%20%7D%3B%0A%2F%2F%20%7D%0A%0Aif%20%28%22opacity%22%20in%20data%29%20%7B%0A%20%20trace.marker.opacity%20%3D%20data.opacity%3B%0A%7D%0A%0Avar%20plot_data%20%3D%20%5Btrace%5D%3B%0A%0Avar%20layout%20%3D%20%7B%0A%20%20title%3A%20%22Plot%20Title%22%2C%0A%20%20xaxis%3A%20%7B%0A%20%20%20%20title%3A%20%22x%20Axis%22%2C%0A%20%20%7D%2C%0A%20%20yaxis%3A%20%7B%0A%20%20%20%20title%3A%20%22y%20Axis%22%2C%0A%20%20%7D%2C%0A%20%20width%3A%20data.width%2C%0A%20%20height%3A%20data.height%2C%0A%20%20autosize%3A%20true%2C%0A%7D%3B%0A%0Aif%20%28%22title%22%20in%20data%29%20%7B%0A%20%20layout.title%20%3D%20data.title%3B%0A%7D%0A%0Aif%20%28%22xaxis_title%22%20in%20data%29%20%7B%0A%20%20layout.xaxis.title%20%3D%20data.xaxis_title%3B%0A%7D%0A%0Aif%20%28%22yaxis_title%22%20in%20data%29%20%7B%0A%20%20layout.yaxis.title%20%3D%20data.yaxis_title%3B%0A%7D%0A%0Alayout.xaxis.type%20%3D%20data%5B%22xaxis_type%22%5D%3B%0Alayout.yaxis.type%20%3D%20data%5B%22yaxis_type%22%5D%3B%0A%0Aif%20%28%22ydomain%22%20in%20data%29%7B%0A%20%20layout.yaxis.domain%20%3D%20data.ydomain%3B%0A%7D%0Aif%20%28%22xdomain%22%20in%20data%29%7B%0A%20%20layout.xaxis.domain%20%3D%20data.xdomain%3B%0A%7D%0A%0Aif%20%28%22yrange%22%20in%20data%29%7B%0A%20%20layout.yaxis.range%20%3D%20data.yrange%3B%0A%7D%0Aif%20%28%22xrange%22%20in%20data%29%7B%0A%20%20layout.xaxis.range%20%3D%20data.xrange%3B%0A%7D%0A%0Aif%20%28%22axesratio%22%20in%20data%29%7B%0A%20%20layout.yaxis.scaleanchor%20%3D%20%22x%22%3B%0A%20%20layout.yaxis.scaleratio%20%3D%20data.axesratio%3B%0A%7D%0A%0Aif%20%28%22xdtick%22%20in%20data%29%7B%0A%20%20layout.xaxis.dtick%20%3D%20data.xdtick%3B%0A%7D%0A%0Aif%20%28%22ydtick%22%20in%20data%29%7B%0A%20%20layout.yaxis.dtick%20%3D%20data.ydtick%3B%0A%7D%0A%0APlotly.newPlot%28%0A%20%20%22basevis-entry%22%2C%0A%20%20plot_data%2C%0A%20%20layout%2C%0A%20%20%28config%20%3D%20%7B%0A%20%20%20%20displaylogo%3A%20false%2C%0A%20%20%20%20modeBarButtonsToRemove%3A%20%5B%22zoom2d%22%2C%20%22pan2d%22%2C%20%22select2d%22%2C%20%22lasso2d%22%5D%2C%0A%20%20%7D%29%0A%29%3B%0A%0Aif%20%28%22layout_update%22%20in%20data%29%7B%0A%20%20Plotly.update%28%22basevis-entry%22%2C%20%7B%7D%2C%20data.layout_update%29%3B%0A%7D%0A%0Aif%20%28%22trace_update%22%20in%20data%29%7B%0A%20%20Plotly.addTraces%28%22basevis-entry%22%2C%20data.trace_update%29%3B%0A%7D%0A%0Aconst%20hoverCanvas%20%3D%20document.createElement%28%22canvas%22%29%3B%0AhoverCanvas.id%20%3D%20%22hoverCanvas%22%3B%0A%0Aconst%20hoverBackground%20%3D%20document.createElement%28%22canvas%22%29%3B%0AhoverBackground.id%20%3D%20%22hoverBackground%22%3B%0A%0Avar%20hoverSize%20%3D%20parseFloat%28data.hover_size%29%3B%0A%0Aplot.appendChild%28hoverCanvas%29%3B%0Aplot.appendChild%28hoverBackground%29%3B%0A%0Aplot%0A%20%20.on%28%22plotly_hover%22%2C%20function%20%28data%29%20%7B%0A%20%20%20%20var%20xaxis%20%3D%20data.points%5B0%5D.xaxis%2C%0A%20%20%20%20%20%20yaxis%20%3D%20data.points%5B0%5D.yaxis%3B%0A%0A%20%20%20%20data.points.map%28function%20%28d%29%20%7B%0A%20%20%20%20%20%20hoverCanvas.hidden%20%3D%20false%3B%0A%20%20%20%20%20%20hoverBackground.hidden%20%3D%20false%3B%0A%0A%20%20%20%20%20%20ctx%20%3D%20hoverCanvas.getContext%28%222d%22%29%3B%0A%0A%20%20%20%20%20%20SmilesDrawer.parse%28d.text%2C%20function%20%28smiles%29%20%7B%0A%20%20%20%20%20%20%20%20smilesDrawer.draw%28smiles%2C%20%22hoverCanvas%22%2C%20%22light%22%2C%20false%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%20%20ctx.fillStyle%20%3D%20%22black%22%3B%0A%20%20%20%20%20%20ctx.shadowColor%20%3D%20%22black%22%3B%0A%20%20%20%20%20%20ctx.shadowBlur%20%3D%2020%3B%0A%20%20%20%20%20%20ctx.lineJoin%20%3D%20%22bevel%22%3B%0A%20%20%20%20%20%20ctx.lineWidth%20%3D%2015%3B%0A%20%20%20%20%20%20ctx.strokeRect%280%2C%200%2C%20hoverCanvas.width%2C%20hoverCanvas.height%2C%20%22light%22%29%3B%0A%0A%20%20%20%20%20%20hoverBackground.width%20%3D%20hoverCanvas.width%3B%0A%20%20%20%20%20%20hoverBackground.height%20%3D%20hoverCanvas.height%3B%0A%20%20%20%20%20%20ctx%20%3D%20hoverBackground.getContext%28%222d%22%29%3B%0A%20%20%20%20%20%20ctx.fillStyle%20%3D%20%22white%22%3B%0A%20%20%20%20%20%20ctx.fillRect%280%2C%200%2C%20hoverBackground.width%2C%20hoverBackground.height%29%3B%0A%0A%20%20%20%20%20%20Plotly.update%28%0A%20%20%20%20%20%20%20%20%22basevis-entry%22%2C%0A%20%20%20%20%20%20%20%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20margin%3A%20%7B%20t%3A%20100%2C%20b%3A%20100%2C%20l%3A%2050%2C%20r%3A%2050%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20annotations%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20d.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20d.y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xref%3A%20%22x%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yref%3A%20%22y%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3A%20%22%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20showarrow%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowhead%3A%207%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20ax%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20ay%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20images%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20%28d.x%20-%20xaxis.range%5B0%5D%29%20%2F%20%28xaxis.range%5B1%5D%20-%20xaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20%28d.y%20-%20yaxis.range%5B0%5D%29%20%2F%20%28yaxis.range%5B1%5D%20-%20yaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizex%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizey%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20source%3A%20document.getElementById%28%22hoverBackground%22%29.toDataURL%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xanchor%3A%20%22left%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yanchor%3A%20%22top%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3A%20%22above%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20%28d.x%20-%20xaxis.range%5B0%5D%29%20%2F%20%28xaxis.range%5B1%5D%20-%20xaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20%28d.y%20-%20yaxis.range%5B0%5D%29%20%2F%20%28yaxis.range%5B1%5D%20-%20yaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizex%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizey%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20source%3A%20document.getElementById%28%22hoverCanvas%22%29.toDataURL%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xanchor%3A%20%22left%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yanchor%3A%20%22top%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3A%20%22above%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20hoverCanvas.hidden%20%3D%20true%3B%0A%20%20%20%20%20%20hoverBackground.hidden%20%3D%20true%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%29%0A%20%20.on%28%22plotly_unhover%22%2C%20function%20%28data%29%20%7B%0A%20%20%20%20Plotly.update%28%22basevis-entry%22%2C%20%7B%7D%2C%20%7B%20annotations%3A%20%5B%5D%2C%20images%3A%20%5B%5D%20%7D%29%3B%0A%20%20%7D%29%3B%0A%3C%2Fscript%3E%3Cscript%3E%20window.addEventListener%28%22resize%22%2C%20function%28%29%7Bif%20%28document.getElementById%28%22basevis-entry%22%29%29%20%7BPlotly.Plots.resize%28document.getElementById%28%22basevis-entry%22%29%29%3B%7D%3B%7D%29%20%3C%2Fscript%3E"
        frameborder="0"
        allowfullscreen
    
    ></iframe>




Counterfactuals can also be plotted in their original PCA space by
setting ``pca=True``:

.. code:: ipython3

    vis = oce.VisualizeCounterfactual(smiles, model, delta=0.5, pca=True)

.. code:: ipython3

    vis.render_ipynb()




.. raw:: html

    
    <iframe
        width="800"
        height="600"
        src="data:text/html,%0A%20%20%20%20%20%20%20%20%3C%21DOCTYPE%20html%3E%0A%20%20%20%20%20%20%20%20%3Chead%3E%0A%20%20%20%20%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%3E%0A%20%20%20%20%20%20%20%20%3C%2Fhead%3E%0A%0A%20%20%20%20%20%20%20%20%3Chtml%20style%3D%22height%3A%20100%25%3B%22%3E%0A%0A%20%20%20%20%20%20%20%20%3C%21--%20Load%20packages%20--%3E%0A%20%20%20%20%20%20%20%20%3Cscript%20src%3D%22https%3A%2F%2Fcdn.plot.ly%2Fplotly-2.12.1.min.js%22%3E%3C%2Fscript%3E%3Cscript%20src%3D%22https%3A%2F%2Funpkg.com%2Fsmiles-drawer%401.0.10%2Fdist%2Fsmiles-drawer.min.js%22%3E%3C%2Fscript%3E%0A%20%20%20%20%20%20%20%20%3Cbody%20style%3D%22background-color%3A%23FFFFFF%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%3C%21--%20Create%20a%20div%20where%20the%20graph%20will%20take%20place%20--%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22basevis-entry%22%20data-visdata%3D%22%7B%26quot%3BSMILES%26quot%3B%3A%20%5B%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNC%5BNH2%2B%5D2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29cnc1%5BO-%5D%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28C3%29CP%28C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28C%5BNH%2B%5D2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CP%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2NCCC%5BNH2%2B%5D2%29ccc1Cl%26quot%3B%2C%20%26quot%3BCc1cc%28Cl%29c%28C%28%3DO%29NCC23CC4CC%28CC%28C4%29C2%29C3%29c%5Bn%2B%5D1CC1CCNCC1%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cn%5BnH%2B%5Dc%28CC2CCNCC2%29c1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28C2CCCNCC%5BNH2%2B%5D2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CN%28C3%29N1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCOCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNSC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCO2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCC23CC3%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28SC2CCNCS2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc2c%28cc1Cl%29C1CNCCOC2O1%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29C1%3DCN%3DC%28C2C3CNCC32%29C%3DCC%3DC1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28C3%29CC%28C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BCc1ccc%28CC2CCNCC2%29cc1C%28%3DO%29NCC12CC3CC%28CC%28C3%29C1%29C2%26quot%3B%2C%20%26quot%3BS%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29cc%28Cl%29c1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNNC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BCC%28C%29%28C%29c1ccc%28CC2CCNCC2%29cc1C%28%3DO%29NCC12CC3CC%28CC%28C3%29C1%29C2%26quot%3B%2C%20%26quot%3BNN%28CC12CC3CC%28CC%28C3%29C1%29C2%29C%28%3DO%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29%5BnH%2B%5Dcc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCN2%29ccc1Cl%26quot%3B%2C%20%26quot%3BCc1%5BnH%2B%5Dcc%28CC2CCNCC2%29cc1C%28%3DO%29NCC12CC3CC%28CC%28C3%29C1%29C2%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1nc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BOC%28%3DNCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DS%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28C1%29NC%28C3%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BClc1ccc%28CC2CCNCC2%29cc1SNCC12CC3CC%28CC%28C3%29C1%29C2%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28C3%29C%5BNH%2B%5D%28C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BCC%28%3DO%29C%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28O%29%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%2C%20%26quot%3BO%3DC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%5BnH%2B%5Dc%28CC2CCNCC2%29c1Cl%26quot%3B%2C%20%26quot%3BCC%28NCC12CC3CC%28CC%28C3%29C1%29C2%29c1cc%28CC2CCNCC2%29ccc1Cl%26quot%3B%5D%2C%20%26quot%3BX%26quot%3B%3A%20%5B-2.2919870348721862%2C%20-3.374920560860962%2C%20-4.2959903562715125%2C%203.5582098634044947%2C%20-3.9496768785422716%2C%203.6140188096708954%2C%20-3.469848502822847%2C%20-5.383756150014369%2C%20-5.441566679459704%2C%20-4.778722401095822%2C%205.727498566531979%2C%20-3.0657342735902806%2C%20-2.8660712561997963%2C%20-2.8161351124464575%2C%20-3.3809087390462267%2C%20-3.713147545591252%2C%20-4.6601489721685585%2C%20-4.977129290215063%2C%20-5.258272182704754%2C%200.030688902407406727%2C%20-3.1474510964873006%2C%20-2.3996835377545436%2C%20-3.9761577227862572%2C%20-2.8245200950028133%2C%20-2.6883883027743884%2C%20-1.071084699696558%2C%20-4.910983864537131%2C%20-3.3960039231201566%2C%20-4.25663919443639%2C%20-5.0833924694834804%2C%20-1.0398479138284977%2C%20-2.5581272926667586%2C%203.401282266289701%2C%20-2.6206378810723763%2C%203.6183574220915204%2C%20-2.5000955564114995%2C%203.1829640953514544%2C%20-5.243156757579972%2C%20-2.553733634968225%5D%2C%20%26quot%3BY%26quot%3B%3A%20%5B8.1311242625323%2C%206.317555324635991%2C%200.9146974068040669%2C%203.4099900456233385%2C%204.966521826492752%2C%203.051726771001894%2C%205.647322825094168%2C%200.7045872105528577%2C%20-0.4150681899775486%2C%203.2181962423190655%2C%201.7052206904054403%2C%207.99859092986411%2C%206.213433771754989%2C%206.641621522388017%2C%206.461501708427447%2C%205.5406723431882385%2C%203.5180757708913%2C%200.028865049967442484%2C%20-2.84612771023443%2C%206.901161777777904%2C%203.963485902990778%2C%203.875990225430868%2C%202.628322338175034%2C%206.745755082817034%2C%202.5428091897894913%2C%201.9743315317483703%2C%202.0930553990700584%2C%206.4650303827543345%2C%201.0208761953220151%2C%201.4514521097853648%2C%201.1609053679602475%2C%200.9024271458922332%2C%203.989067348693431%2C%200.6750898300037319%2C%203.4640197619593316%2C%201.3137519753574363%2C%203.212250379099908%2C%200.7795811407903629%2C%200.453785921299129%5D%2C%20%26quot%3Bcolor%26quot%3B%3A%20%5B%26quot%3B%2300CC96%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23636EFA%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23EF553B%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%2C%20%26quot%3B%23FECB52%26quot%3B%5D%2C%20%26quot%3Bhovertemplate%26quot%3B%3A%20%5B%26quot%3Bf%28x%29%20%3D%201.811%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.78%3Cbr%3Ef%28x%29%20%3D%201.221%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.275%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.271%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.74%3Cbr%3Ef%28x%29%20%3D%200.949%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.74%3Cbr%3Ef%28x%29%20%3D%201.27%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.73%3Cbr%3Ef%28x%29%20%3D%201.093%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.71%3Cbr%3Ef%28x%29%20%3D%201.306%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.71%3Cbr%3Ef%28x%29%20%3D%201.252%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.69%3Cbr%3Ef%28x%29%20%3D%201.309%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.66%3Cbr%3Ef%28x%29%20%3D%201.287%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.85%3Cbr%3Ef%28x%29%20%3D%203.098%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%203.115%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%202.391%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.78%3Cbr%3Ef%28x%29%20%3D%202.541%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.73%3Cbr%3Ef%28x%29%20%3D%203.101%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.67%3Cbr%3Ef%28x%29%20%3D%202.372%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.55%3Cbr%3Ef%28x%29%20%3D%202.534%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.46%3Cbr%3Ef%28x%29%20%3D%202.317%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.93%3Cbr%3Ef%28x%29%20%3D%201.806%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.86%3Cbr%3Ef%28x%29%20%3D%201.784%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.86%3Cbr%3Ef%28x%29%20%3D%201.954%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%201.934%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%201.435%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.8%3Cbr%3Ef%28x%29%20%3D%201.968%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.78%3Cbr%3Ef%28x%29%20%3D%201.809%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.78%3Cbr%3Ef%28x%29%20%3D%201.406%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.78%3Cbr%3Ef%28x%29%20%3D%201.457%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.352%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.58%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.964%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.845%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.471%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.972%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.47%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.76%3Cbr%3Ef%28x%29%20%3D%201.861%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.75%3Cbr%3Ef%28x%29%20%3D%201.735%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.74%3Cbr%3Ef%28x%29%20%3D%201.33%26quot%3B%2C%20%26quot%3BSimilarity%20%3D%200.74%3Cbr%3Ef%28x%29%20%3D%201.889%26quot%3B%5D%2C%20%26quot%3Bgroup%26quot%3B%3A%20%5B%26quot%3BBase%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BLow%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BHigh%20Counterfactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%2C%20%26quot%3BFactual%26quot%3B%5D%2C%20%26quot%3Bsize%26quot%3B%3A%20%5B12%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%2C%2012%5D%2C%20%26quot%3Btitle%26quot%3B%3A%20%26quot%3BCounterfactual%20Visualization%26quot%3B%2C%20%26quot%3Bxaxis_title%26quot%3B%3A%20%26quot%3BComponent%201%26quot%3B%2C%20%26quot%3Byaxis_title%26quot%3B%3A%20%26quot%3BComponent%202%26quot%3B%2C%20%26quot%3Bhover_size%26quot%3B%3A%200.4%2C%20%26quot%3Bxaxis_type%26quot%3B%3A%20%26quot%3Blinear%26quot%3B%2C%20%26quot%3Byaxis_type%26quot%3B%3A%20%26quot%3Blinear%26quot%3B%2C%20%26quot%3Bwidth%26quot%3B%3A%20800%2C%20%26quot%3Bheight%26quot%3B%3A%20600%2C%20%26quot%3Bopacity%26quot%3B%3A%201%7D%22%20style%3D%22width%3A%20100%25%3B%20height%3A%20100%25%3B%20display%3Ainline-block%3B%22%3E%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%3C%2Fbody%3E%0A%20%20%20%20%20%20%20%20%3C%2Fmeta%3E%0A%20%20%20%20%20%20%20%20%3Cscript%3Evar%20plot%20%3D%20document.getElementById%28%22basevis-entry%22%29%3B%0Avar%20hoverInfo%20%3D%20document.getElementById%28%22basevis-entry2%22%29%3B%0A%0Avar%20data%20%3D%20JSON.parse%28document.getElementById%28%22basevis-entry%22%29.dataset.visdata%29%3B%0A%0Alet%20options%20%3D%20%7B%7D%3B%0Alet%20smilesDrawer%20%3D%20new%20SmilesDrawer.Drawer%28options%29%3B%0A%0Avar%20trace%20%3D%20%7B%0A%20%20x%3A%20data.X%2C%0A%20%20y%3A%20data.Y%2C%0A%20%20text%3A%20data.SMILES%2C%0A%20%20mode%3A%20%22markers%22%2C%0A%20%20type%3A%20%22scatter%22%2C%0A%20%20hoverinfo%3A%20%22none%22%2C%0A%20%20marker%3A%20%7B%7D%2C%0A%7D%3B%0A%0Aif%20%28%22hovertext%22%20in%20data%29%20%7B%0A%20%20trace.hovertext%20%3D%20data.hovertext%3B%0A%20%20trace.hoverinfo%20%3D%20%22text%22%3B%0A%7D%0A%0Aif%20%28%22group%22%20in%20data%29%20%7B%0A%20%20trace.transforms%20%3D%20%5B%7B%20type%3A%20%22groupby%22%2C%20groups%3A%20data.group%20%7D%5D%3B%0A%7D%0A%0Aif%20%28%22hovertemplate%22%20in%20data%29%20%7B%0A%20%20trace.hovertemplate%20%3D%20data.hovertemplate%3B%0A%7D%0A%0Aif%20%28%22color%22%20in%20data%29%20%7B%0A%20%20trace.marker.color%20%3D%20data.color%3B%0A%7D%0A%0Aif%20%28%22size%22%20in%20data%29%20%7B%0A%20%20trace.marker.size%20%3D%20data.size%3B%0A%7D%20else%20%7B%0A%20%20trace.marker.size%20%3D%2012%3B%0A%7D%0A%0Aif%20%28%22colorscale%22%20in%20data%29%20%7B%0A%20%20trace.colorscale%20%3D%20data.colorscale%3B%0A%20%20trace.marker.colorscale%20%3D%20data.colorscale%3B%0A%20%20trace.marker.colorbar%20%3D%20%7B%0A%20%20%20%20title%3A%20%22%22%2C%0A%20%20%20%20titleside%3A%20%22top%22%2C%0A%20%20%7D%3B%0A%7D%0A%0A%2F%2F%20if%20%28%22outline%22%20in%20data%29%20%7B%0A%2F%2F%20%20%20trace.marker.line%20%3D%20%7B%0A%2F%2F%20%20%20%20%20color%3A%20data.outline%2C%0A%2F%2F%20%20%20%20%20width%3A%204%2C%0A%2F%2F%20%20%20%7D%3B%0A%2F%2F%20%7D%0A%0Aif%20%28%22opacity%22%20in%20data%29%20%7B%0A%20%20trace.marker.opacity%20%3D%20data.opacity%3B%0A%7D%0A%0Avar%20plot_data%20%3D%20%5Btrace%5D%3B%0A%0Avar%20layout%20%3D%20%7B%0A%20%20title%3A%20%22Plot%20Title%22%2C%0A%20%20xaxis%3A%20%7B%0A%20%20%20%20title%3A%20%22x%20Axis%22%2C%0A%20%20%7D%2C%0A%20%20yaxis%3A%20%7B%0A%20%20%20%20title%3A%20%22y%20Axis%22%2C%0A%20%20%7D%2C%0A%20%20width%3A%20data.width%2C%0A%20%20height%3A%20data.height%2C%0A%20%20autosize%3A%20true%2C%0A%7D%3B%0A%0Aif%20%28%22title%22%20in%20data%29%20%7B%0A%20%20layout.title%20%3D%20data.title%3B%0A%7D%0A%0Aif%20%28%22xaxis_title%22%20in%20data%29%20%7B%0A%20%20layout.xaxis.title%20%3D%20data.xaxis_title%3B%0A%7D%0A%0Aif%20%28%22yaxis_title%22%20in%20data%29%20%7B%0A%20%20layout.yaxis.title%20%3D%20data.yaxis_title%3B%0A%7D%0A%0Alayout.xaxis.type%20%3D%20data%5B%22xaxis_type%22%5D%3B%0Alayout.yaxis.type%20%3D%20data%5B%22yaxis_type%22%5D%3B%0A%0Aif%20%28%22ydomain%22%20in%20data%29%7B%0A%20%20layout.yaxis.domain%20%3D%20data.ydomain%3B%0A%7D%0Aif%20%28%22xdomain%22%20in%20data%29%7B%0A%20%20layout.xaxis.domain%20%3D%20data.xdomain%3B%0A%7D%0A%0Aif%20%28%22yrange%22%20in%20data%29%7B%0A%20%20layout.yaxis.range%20%3D%20data.yrange%3B%0A%7D%0Aif%20%28%22xrange%22%20in%20data%29%7B%0A%20%20layout.xaxis.range%20%3D%20data.xrange%3B%0A%7D%0A%0Aif%20%28%22axesratio%22%20in%20data%29%7B%0A%20%20layout.yaxis.scaleanchor%20%3D%20%22x%22%3B%0A%20%20layout.yaxis.scaleratio%20%3D%20data.axesratio%3B%0A%7D%0A%0Aif%20%28%22xdtick%22%20in%20data%29%7B%0A%20%20layout.xaxis.dtick%20%3D%20data.xdtick%3B%0A%7D%0A%0Aif%20%28%22ydtick%22%20in%20data%29%7B%0A%20%20layout.yaxis.dtick%20%3D%20data.ydtick%3B%0A%7D%0A%0APlotly.newPlot%28%0A%20%20%22basevis-entry%22%2C%0A%20%20plot_data%2C%0A%20%20layout%2C%0A%20%20%28config%20%3D%20%7B%0A%20%20%20%20displaylogo%3A%20false%2C%0A%20%20%20%20modeBarButtonsToRemove%3A%20%5B%22zoom2d%22%2C%20%22pan2d%22%2C%20%22select2d%22%2C%20%22lasso2d%22%5D%2C%0A%20%20%7D%29%0A%29%3B%0A%0Aif%20%28%22layout_update%22%20in%20data%29%7B%0A%20%20Plotly.update%28%22basevis-entry%22%2C%20%7B%7D%2C%20data.layout_update%29%3B%0A%7D%0A%0Aif%20%28%22trace_update%22%20in%20data%29%7B%0A%20%20Plotly.addTraces%28%22basevis-entry%22%2C%20data.trace_update%29%3B%0A%7D%0A%0Aconst%20hoverCanvas%20%3D%20document.createElement%28%22canvas%22%29%3B%0AhoverCanvas.id%20%3D%20%22hoverCanvas%22%3B%0A%0Aconst%20hoverBackground%20%3D%20document.createElement%28%22canvas%22%29%3B%0AhoverBackground.id%20%3D%20%22hoverBackground%22%3B%0A%0Avar%20hoverSize%20%3D%20parseFloat%28data.hover_size%29%3B%0A%0Aplot.appendChild%28hoverCanvas%29%3B%0Aplot.appendChild%28hoverBackground%29%3B%0A%0Aplot%0A%20%20.on%28%22plotly_hover%22%2C%20function%20%28data%29%20%7B%0A%20%20%20%20var%20xaxis%20%3D%20data.points%5B0%5D.xaxis%2C%0A%20%20%20%20%20%20yaxis%20%3D%20data.points%5B0%5D.yaxis%3B%0A%0A%20%20%20%20data.points.map%28function%20%28d%29%20%7B%0A%20%20%20%20%20%20hoverCanvas.hidden%20%3D%20false%3B%0A%20%20%20%20%20%20hoverBackground.hidden%20%3D%20false%3B%0A%0A%20%20%20%20%20%20ctx%20%3D%20hoverCanvas.getContext%28%222d%22%29%3B%0A%0A%20%20%20%20%20%20SmilesDrawer.parse%28d.text%2C%20function%20%28smiles%29%20%7B%0A%20%20%20%20%20%20%20%20smilesDrawer.draw%28smiles%2C%20%22hoverCanvas%22%2C%20%22light%22%2C%20false%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%20%20ctx.fillStyle%20%3D%20%22black%22%3B%0A%20%20%20%20%20%20ctx.shadowColor%20%3D%20%22black%22%3B%0A%20%20%20%20%20%20ctx.shadowBlur%20%3D%2020%3B%0A%20%20%20%20%20%20ctx.lineJoin%20%3D%20%22bevel%22%3B%0A%20%20%20%20%20%20ctx.lineWidth%20%3D%2015%3B%0A%20%20%20%20%20%20ctx.strokeRect%280%2C%200%2C%20hoverCanvas.width%2C%20hoverCanvas.height%2C%20%22light%22%29%3B%0A%0A%20%20%20%20%20%20hoverBackground.width%20%3D%20hoverCanvas.width%3B%0A%20%20%20%20%20%20hoverBackground.height%20%3D%20hoverCanvas.height%3B%0A%20%20%20%20%20%20ctx%20%3D%20hoverBackground.getContext%28%222d%22%29%3B%0A%20%20%20%20%20%20ctx.fillStyle%20%3D%20%22white%22%3B%0A%20%20%20%20%20%20ctx.fillRect%280%2C%200%2C%20hoverBackground.width%2C%20hoverBackground.height%29%3B%0A%0A%20%20%20%20%20%20Plotly.update%28%0A%20%20%20%20%20%20%20%20%22basevis-entry%22%2C%0A%20%20%20%20%20%20%20%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20margin%3A%20%7B%20t%3A%20100%2C%20b%3A%20100%2C%20l%3A%2050%2C%20r%3A%2050%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20annotations%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20d.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20d.y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xref%3A%20%22x%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yref%3A%20%22y%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3A%20%22%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20showarrow%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowhead%3A%207%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20ax%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20ay%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20images%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20%28d.x%20-%20xaxis.range%5B0%5D%29%20%2F%20%28xaxis.range%5B1%5D%20-%20xaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20%28d.y%20-%20yaxis.range%5B0%5D%29%20%2F%20%28yaxis.range%5B1%5D%20-%20yaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizex%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizey%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20source%3A%20document.getElementById%28%22hoverBackground%22%29.toDataURL%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xanchor%3A%20%22left%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yanchor%3A%20%22top%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3A%20%22above%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20%28d.x%20-%20xaxis.range%5B0%5D%29%20%2F%20%28xaxis.range%5B1%5D%20-%20xaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20%28d.y%20-%20yaxis.range%5B0%5D%29%20%2F%20%28yaxis.range%5B1%5D%20-%20yaxis.range%5B0%5D%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizex%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20sizey%3A%20hoverSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yref%3A%20%22paper%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20source%3A%20document.getElementById%28%22hoverCanvas%22%29.toDataURL%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20xanchor%3A%20%22left%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20yanchor%3A%20%22top%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20layer%3A%20%22above%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20hoverCanvas.hidden%20%3D%20true%3B%0A%20%20%20%20%20%20hoverBackground.hidden%20%3D%20true%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%29%0A%20%20.on%28%22plotly_unhover%22%2C%20function%20%28data%29%20%7B%0A%20%20%20%20Plotly.update%28%22basevis-entry%22%2C%20%7B%7D%2C%20%7B%20annotations%3A%20%5B%5D%2C%20images%3A%20%5B%5D%20%7D%29%3B%0A%20%20%7D%29%3B%0A%3C%2Fscript%3E%3Cscript%3E%20window.addEventListener%28%22resize%22%2C%20function%28%29%7Bif%20%28document.getElementById%28%22basevis-entry%22%29%29%20%7BPlotly.Plots.resize%28document.getElementById%28%22basevis-entry%22%29%29%3B%7D%3B%7D%29%20%3C%2Fscript%3E"
        frameborder="0"
        allowfullscreen
    
    ></iframe>




In this space, molecules closer to each other have a greater similarity.
Thus, different clusters of molecules correspond to different high-level
modifications of the reference molecule. Subclusters correspond to more
specific modifications within these groups.
